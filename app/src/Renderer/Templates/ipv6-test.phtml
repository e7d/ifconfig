<?php
$domain = $_SERVER["HTTP_HOST"];
?>

<link rel="stylesheet" href="//<?= $domain ?>/css/ipv6-test.css">

<header>
    <h1><a class="h1" href="/">ipv6-test</a></h1>
</header>

<input type="checkbox" id="modal">
<label for="modal" class="modal-background"></label>
<div class="modal">
    <div class="modal-header">
        <h3 class="modal-title"></h3>
        <label for="modal" class="modal-close">Ã—</label>
    </div>
    <p class="modal-content"></p>
</div>

<main>
    <section id="score-info">
        <h2>Score</h2>
        <ul>
            <li>
                <span class="progress">
                    <span class="progress-bar" style="width: 0%;"></span>
                </span>
                <span class="score-value">0 / 20</span>
            </li>
            <li class="score-details">
                <label for="modal" title="The IPv4 connectivity will remain necessary as long as the transition to IPv6 is not fully executed.">IPv4</label>
                <span class="score-ipv4"><span class="value">0</span> / 2</span>
            </li>
            <li class="score-details">
                <label for="modal" title="The IPv6 connectivity is the main requirement.">IPv6</label>
                <span class="score-ipv6"><span class="value">0</span> / 10</span>
            </li>
            <li class="score-details">
                <label for="modal" title="A fast fallback from one protocol to the other is necessary to prevent navigation issues.">Fallback</label>
                <span class="score-fallback"><span class="value">0</span> / 3</span>
            </li>
            <li class="score-details">
                <label for="modal" title="A native IPv6 is preferred over any IPv4 to IPv6 tunnel or translation technique. Also, using a public IPv6 assigned using SLAAC without privacy extensions (RFC4941) is discouraged, as it presents some security risks.">IPv6 Type</label>
                <span class="score-ipv6-type"><span class="value">0</span> / 4</span>
            </li>
            <li class="score-details">
                <label for="modal" title="A working public ICMPv6 connectivity is not a requirement, but ensures smooth IPv6 operation.">ICMPv6</label>
                <span class="score-icmpv6"><span class="value">0</span> / 1</span>
            </li>
        </ul>
    </section>
    <section id="browser-info">
        <h2>Browser</h2>
        <ul>
            <li>
                <label for="modal" title="The protocol selected by your browser when a website advertises both IPv4 and IPV6 addresses.">Default</label>
                <span class="default"><span class="loader"></span></span>
            </li>
            <li>
                <label for="modal" title="The ability for your browser to fallback to the other protocol.">Fallback</label>
                <span class="fallback"><span class="loader"></span></span>
            </li>
        </ul>
    </section>
    <section id="ipv4-info">
        <h2>IPv4 connectivity</h2>
        <ul>
            <li>
                <label for="modal" title="The IPv4 protocol support.">IPv4</label>
                <span class="ip"><span class="loader"></span></span>
            </li>
            <li>
                <label for="modal" title="The public IPv4 address of your connection.">Address</label>
                <span class="address"></span>
            </li>
            <li>
                <label for="modal" title="The public IPv4 hostname of your connection.">Hostname</label>
                <span class="hostname"></span>
            </li>
            <li>
                <label for="modal" title="The public information available about your Internet sevice provider.">ASN</label>
                <span class="asn"></span>
            </li>
        </ul>
    </section>
    <section id="ipv6-info">
        <h2>IPv6 connectivity</h2>
        <ul>
            <li>
                <label for="modal" title="The IPv6 protocol support.">IPv6</label>
                <span class="ip"><span class="loader"></span></span>
            </li>
            <li>
                <label for="modal" title="The public IPv6 address of your connection.">Address</label>
                <span class="address"></span>
            </li>
            <li>
                <label for="modal" title="The public IPv6 hostname of your connection.">Hostname</label>
                <span class="hostname"></span>
            </li>
            <li>
                <label for="modal" title="The public information available about your Internet sevice provider.">ASN</label>
                <span class="asn"></span>
            </li>
            <li>
                <label for="modal" title="The type type of public IPv6 of your connection. Native means a direct IPv6 connectivity. Other values are IPv4 to IPv6 tunnels or translation techniques to provide IPv6 support in networks that don't fully support IPv6 yet.">Type</label>
                <span class="type"></span>
            </li>
            <li>
                <label for="modal" title="The use of stateless address autoconfiguration (SLAAC) to get your IPv6 or not. SLAAC is a mean for an IPv6 host to assign itself an address based on its hardware MAC without asking a DHCP server. Using SLAAC without privacy extensions (RFC4941) is not recommended.">SLAAC</label>
                <span class="slaac"></span>
            </li>
            <li class="mac">
                <label for="modal" title="The MAC address used to construct your SLAAC IPv6.">MAC Address</label>
                <span class="mac-address"></span>
            </li>
            <li class="mac">
                <label for="modal" title="The vendor that the used MAC address originated from.">MAC Vendor</label>
                <span class="mac-vendor"></span>
            </li>
            <li>
                <label for="modal" title="The availbility to contact your device using ICMPv6. IPv6 relies heavily on the ICMPv6 protocol to signal error and information conditions.">ICMPv6</label>
                <span class="icmp"></span>
            </li>
        </ul>
    </section>
</main>

<script>
    const ENDPOINTS = {
        'auto': '//<?= getenv('HOST_AUTO') ?>/ip.home.e7d.io/json',
        4: '//<?= getenv('HOST_AUTO') ?>/ipv4.home.e7d.io/json',
        6: '//<?= getenv('HOST_AUTO') ?>/ipv6.home.e7d.io/json',
        'ping6': '//<?= getenv('HOST_AUTO') ?>/ipv6.home.e7d.io/ping'
        // 'auto': '//<?= getenv('HOST_AUTO') ?>/json',
        // 4: '//<?= getenv('HOST_IPV4') ?>/json',
        // 6: '//<?= getenv('HOST_IPV6') ?>/json',
        // 'ping6': '//<?= getenv('HOST_IPV6') ?>/ping'
    };
</script>
<script src="//<?= $domain ?>/js/ipv6-test.js"></script>
